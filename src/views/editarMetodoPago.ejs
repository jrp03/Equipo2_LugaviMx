<% layout('layout/layout.ejs') %>
<link rel="stylesheet" href="/css/perfil-formularios.css">

<div class="container mt-5">
  <div class="card shadow">
    <div class="card-header bg-primary text-white">
      <h3 class="mb-0">Editar Método de Pago</h3>
    </div>
    <div class="card-body">
      <!-- Mostrar mensajes de error -->
      <% if (error && error.length > 0) { %>
        <div class="alert alert-danger"><%= error[0] %></div>
      <% } %>
      <% if (exito && exito.length > 0) { %>
        <div class="alert alert-success"><%= exito[0] %></div>
      <% } %>

      <form action="/perfil/editar-metodo-pago/<%= index %>" method="POST">
        <div class="mb-3">
          <label for="cardType" class="form-label">Tipo de tarjeta</label>
          <select class="form-select" id="cardType" name="cardType" required>
            <option value="">Seleccionar tipo</option>
            <option value="visa" <%= metodo.cardType === 'visa' ? 'selected' : '' %>>Visa</option>
            <option value="mastercard" <%= metodo.cardType === 'mastercard' ? 'selected' : '' %>>MasterCard</option>
            <option value="amex" <%= metodo.cardType === 'amex' ? 'selected' : '' %>>American Express</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="cardNumber" class="form-label">Número de tarjeta</label>
          <input type="text" class="form-control" id="cardNumber" name="cardNumber"
                 value="<%= metodo.cardNumber %>" maxlength="16" required>
        </div>

        <div class="mb-3">
          <label for="expiryDate" class="form-label">Fecha de expiración</label>
          <input type="month" class="form-control" id="expiryDate" name="expiryDate"
                 value="<%= metodo.expiryDate %>" required>
        </div>

        <div class="mb-3">
          <label for="cardholderName" class="form-label">Nombre del titular</label>
          <input type="text" class="form-control" id="cardholderName" name="cardholderName"
                 value="<%= metodo.cardholderName %>" required>
        </div>

        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="isDefault" name="isDefault"
                 <%= metodo.isDefault ? 'checked' : '' %>>
          <label class="form-check-label" for="isDefault">
            Establecer como predeterminada
          </label>
        </div>

        <div class="d-flex justify-content-between mt-4">
          <a href="/perfil" class="btn btn-outline-secondary">Cancelar</a>
          <button type="submit" class="btn btn-primary">Guardar Cambios</button>
        </div>
      </form>
    </div>
  </div>
</div>

