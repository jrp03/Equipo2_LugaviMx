<% layout('layout/layout.ejs') %>

<div class="container mt-5">
  <div class="card">
    <div class="card-header">
      <h3>Perfil del Usuario</h3>
    </div>
    <div class="card-body">
      <% if (usuario) { %>
        <p><strong>Email:</strong> <%= usuario.email %></p>
        <p><strong>Nombre:</strong> <%= usuario.name %></p>
        <p><strong>Teléfono:</strong> <%= usuario.phoneNumber || 'No registrado' %></p>

        <% if (usuario.profilePicture) { %>
          <div>
            <strong>Foto de perfil:</strong><br>
            <img src="<%= usuario.profilePicture %>" alt="Foto de perfil" style="max-width: 150px; border-radius: 8px;">
          </div>
        <% } %>

        <hr>

        <h5>Direcciones de envío</h5>
        <% if (usuario.shippingAddresses && usuario.shippingAddresses.length > 0) { %>
          <ul>
            <% usuario.shippingAddresses.forEach(function(dir) { %>
              <li>
                <%= dir.addressLine1 %>, <%= dir.addressLine2 ? dir.addressLine2 + ',' : '' %> <%= dir.city %>, <%= dir.state %>, <%= dir.postalCode %>, <%= dir.country %> 
                <% if (dir.isDefault) { %><strong>(Predeterminada)</strong><% } %>
              </li>
            <% }) %>
          </ul>
        <% } else { %>
          <p>No hay direcciones registradas.</p>
        <% } %>

        <hr>

        <h5>Métodos de pago</h5>
        <% if (usuario.paymentMethods && usuario.paymentMethods.length > 0) { %>
          <ul>
            <% usuario.paymentMethods.forEach(function(pm) { %>
              <li>
                <strong>Tipo:</strong> <%= pm.cardType.toUpperCase() %> - <strong>Titular:</strong> <%= pm.cardholderName %> 
                <% if (pm.isDefault) { %><strong>(Predeterminado)</strong><% } %>
              </li>
            <% }) %>
          </ul>
        <% } else { %>
          <p>No hay métodos de pago registrados.</p>
        <% } %>

      <% } else { %>
        <p>No se encontró la información del usuario.</p>
      <% } %>

      <a href="/" class="btn btn-primary mt-3">Volver al inicio</a>
    </div>
  </div>
</div>
